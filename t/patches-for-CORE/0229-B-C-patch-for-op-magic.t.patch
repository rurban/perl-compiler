From 8513c65f3f00f246dffee9bb9aa71f059cb2d106 Mon Sep 17 00:00:00 2001
From: Nicolas Rochelemagne <rochelemagne@cpanel.net>
Date: Fri, 25 Sep 2015 12:21:55 -0500
Subject: [PATCH 229/398] B::C patch for op/magic.t

---
 t/CORE/op/magic.t | 15 +++++----------
 1 file changed, 5 insertions(+), 10 deletions(-)

diff --git a/t/CORE/op/magic.t b/t/CORE/op/magic.t
index e651ad5..a31ed41 100644
--- a/t/CORE/op/magic.t
+++ b/t/CORE/op/magic.t
@@ -2,18 +2,17 @@
 
 BEGIN {
     $| = 1;
-    chdir 't' if -d 't';
-    @INC = '../lib';
-    require './test.pl';
-    plan (tests => 187);
+    require 't/CORE/test.pl';
 }
 
+plan (tests => 187);
+
 # Test that defined() returns true for magic variables created on the fly,
 # even before they have been created.
 # This must come first, even before turning on warnings or setting up
 # $SIG{__WARN__}, to avoid invalidating the tests.  warnings.pm currently
 # does not mention any special variables, but that could easily change.
-BEGIN {
+{
     # not available in miniperl
     my %non_mini = map { $_ => 1 } qw(+ - [);
     for (qw(
@@ -56,11 +55,7 @@ $Is_Dos      = $^O eq 'dos';
 $Is_os2      = $^O eq 'os2';
 $Is_Cygwin   = $^O eq 'cygwin';
 
-$PERL =
-   ($Is_NetWare ? 'perl'   :
-    $Is_VMS     ? $^X      :
-    $Is_MSWin32 ? '.\perl' :
-                  './perl');
+$PERL = $^X;
 
 sub env_is {
     my ($key, $val, $desc) = @_;
-- 
2.5.0

