{"version":1,"ops":[{"type":1,"author":{"id":"dc64d6d260e2683565fe6e13d60cfbe9fec0fa09"},"timestamp":1426200026,"metadata":{"github-id":"MDU6SXNzdWU2MDkyNDI4OA==","github-url":"https://github.com/rurban/perl-compiler/issues/35","origin":"github"},"title":"B::CC fails on interpolated string assignment without -O[01]","message":"Original [issue 33](https://code.google.com/p/perl-compiler/issues/detail?id=33) created by rurban on 2010-08-16T10:31:16.000Z:\n\nB::CC fails if applied to this test program.\n# fail1.pl:\n\nsub f {\nmy $v;\nmy $a = 1;\n$v = \u0026quot;$a,$a\u0026quot;;\n# }\n\n$ perl -MO=CC,-ofail1.c fail1.pl\nModification of non-creatable array value attempted, subscript -1 at /usr/local/lib/perl/5.10.1/B/CC.pm line 929.\nCHECK failed--call queue aborted.\n\nBut it gives a correct result if optimization level 0 or 1 is stated explicitly:\n$ perl -MO=CC,-O0,-ofail1.c fail1.pl\nfail1.pl syntax OK\n$ cc_harness -o fail1 fail1.c\ncc -D_REENTRANT -D_GNU_SOURCE -DDEBIAN -fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -I/usr/lib/perl/5.10/CORE -o fail1 fail1.c -Wl,-E -fstack-protector -L/usr/local/lib -L/usr/lib/perl/5.10/CORE /usr/lib/libperl.so.5.10.1 -ldl -lm -lpthread -lc -lcrypt\nfail1.c: In function ‘perl_init_aaaa’:\nfail1.c:233: warning: assignment from incompatible pointer type\nfail1.c:246: warning: assignment from incompatible pointer type\nfail1.c:255: warning: assignment from incompatible pointer type\nfail1.c:279: warning: assignment from incompatible pointer type\nfail1.c:352: warning: assignment from incompatible pointer type\nfail1.c:408: warning: assignment from incompatible pointer type\n$ ./fail1\n1,1\n\nWith optimization level 2, it compiles, but the result is wrong:\n$ perl -MO=CC,-O2,-ofail1.c fail1.pl\nfail1.pl syntax OK\n$ cc_harness -o fail1 fail1.c\ncc -D_REENTRANT -D_GNU_SOURCE -DDEBIAN -fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -I/usr/lib/perl/5.10/CORE -o fail1 fail1.c -Wl,-E -fstack-protector -L/usr/local/lib -L/usr/lib/perl/5.10/CORE /usr/lib/libperl.so.5.10.1 -ldl -lm -lpthread -lc -lcrypt\nfail1.c: In function ‘perl_init_aaaa’:\nfail1.c:233: warning: assignment from incompatible pointer type\nfail1.c:246: warning: assignment from incompatible pointer type\nfail1.c:255: warning: assignment from incompatible pointer type\nfail1.c:279: warning: assignment from incompatible pointer type\nfail1.c:352: warning: assignment from incompatible pointer type\nfail1.c:408: warning: assignment from incompatible pointer type\n$ ./fail1\n\n(empty line)\n\nUsed versions:\n- perl v5.10.1 (*) built for i486-linux-gnu-thread-mult\n  (from Ubuntu 10.04)\n- B::C version 1.27","files":null}]}