{"version":1,"ops":[{"type":1,"author":{"id":"dc64d6d260e2683565fe6e13d60cfbe9fec0fa09"},"timestamp":1426200052,"metadata":{"github-id":"MDU6SXNzdWU2MDkyNDM5NQ==","github-url":"https://github.com/rurban/perl-compiler/issues/37","origin":"github"},"title":"B::CC generates wrong C code for same variable in different scope","message":"Original [issue 35](https://code.google.com/p/perl-compiler/issues/detail?id=35) created by rurban on 2010-08-16T12:10:00.000Z:\n\nThis looks like a tricky B::StackObj issue.\n\nIf B::CC is applied to this test program, the generated C code fails to compile.\n# fail2.pl\n\nsub new {}\nsub test {\n{ my $x = 1; }\nmy $x = 2;\nif ($x != 3) { 4; }\n# }\n\n$ perl -MO=CC,-ofail2.c fail2.pl\nfail2.pl syntax OK\n$ cc_harness -o fail2 fail2.c\ncc -D_REENTRANT -D_GNU_SOURCE -DDEBIAN -fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -I/usr/lib/perl/5.10/CORE -o fail2 fail2.c -Wl,-E -fstack-protector -L/usr/local/lib -L/usr/lib/perl/5.10/CORE /usr/lib/libperl.so.5.10.1 -ldl -lm -lpthread -lc -lcrypt\nfail2.c: In function ‘perl_init_aaaa’:\nfail2.c:234: warning: assignment from incompatible pointer type\nfail2.c:290: warning: assignment from incompatible pointer type\nfail2.c:319: warning: assignment from incompatible pointer type\nfail2.c:331: warning: assignment from incompatible pointer type\nfail2.c:340: warning: assignment from incompatible pointer type\nfail2.c:370: warning: assignment from incompatible pointer type\nfail2.c:379: warning: assignment from incompatible pointer type\nfail2.c:387: warning: assignment from incompatible pointer type\nfail2.c:459: warning: assignment from incompatible pointer type\nfail2.c: In function ‘pp_sub_test’:\nfail2.c:546: error: redeclaration of ‘d_x’ with no linkage\nfail2.c:546: note: previous declaration of ‘d_x’ was here\n\nUsed versions:\n- perl v5.10.1 (*) built for i486-linux-gnu-thread-mult\n  (from Ubuntu 10.04)\n- B::C version 1.27","files":null}]}