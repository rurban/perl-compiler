{"version":1,"ops":[{"type":1,"author":{"id":"dc64d6d260e2683565fe6e13d60cfbe9fec0fa09"},"timestamp":1426203288,"metadata":{"github-id":"MDU6SXNzdWU2MDkzNjU4Ng==","github-url":"https://github.com/rurban/perl-compiler/issues/93","origin":"github"},"title":"Overloaded VERSION symbols fail to xs boot: ExtUtils::CBuilder with Fcntl::VERSION","message":"Original [issue 91](https://code.google.com/p/perl-compiler/issues/detail?id=91) created by rurban on 2012-01-04T19:13:32.000Z:\n\n\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n1. t/testm.sh ExtUtils::CBuilder\n\n$Fcntl::VERSION is an overloaded version object, a RV to HV.\nBut when booting boot_Fcntl() in Perl_xs_version_bootcheck \nit must be a plain PV. Perl_scan_version() does not work with RV's.\n\nWe must special-case such version objects in GV-\u0026gt;save gvsv, probably \nif stash is xsloaded.\n\n(gdb) bt\n# \u0026nbsp;0  0x00007ffff7be1153 in S_rxres_free (rsp=0x1184fe0) at pp_ctl.c:510\n# \u0026nbsp;1  0x00007ffff7bec35b in Perl_dounwind (cxix=-1) at pp_ctl.c:1627\n# \u0026nbsp;2  0x00007ffff79d5cef in S_my_exit_jump () at perl.c:4882\n# \u0026nbsp;3  0x00007ffff79d585d in Perl_my_failure_exit () at perl.c:4868\n# \u0026nbsp;4  0x00007ffff7bee8e1 in Perl_die_unwind (msv=0x1511850) at pp_ctl.c:1794\n# \u0026nbsp;5  0x00007ffff7aa5014 in Perl_vcroak (pat=0x7ffff7d29177 \u0026quot;%s\u0026quot;, args=0x7fffffffd938)\n\n```\nat util.c:1612\n```\n# \u0026nbsp;6  0x00007ffff7aa50b3 in Perl_croak (pat=0x7ffff7d29177 \u0026quot;%s\u0026quot;) at util.c:1657\n# \u0026nbsp;7  0x00007ffff7aaa433 in Perl_scan_version (s=0x128d210 \u0026quot;SCALAR(0x117fe00)\u0026quot;, rv=0x1511770,\n\n```\nqv=0 '\\000') at util.c:4693\n```\n# \u0026nbsp;8  0x00007ffff7aac213 in Perl_upg_version (ver=0x1511770, qv=0 '\\000') at util.c:5010\n# \u0026nbsp;9  0x00007ffff7aabb2b in Perl_new_version (ver=0xfc98b8) at util.c:4921\n# \u0026nbsp;10 0x00007ffff7aafc44 in Perl_xs_version_bootcheck (items=1, ax=2,\n\n```\nxs_p=0x7ffff7fe62ef \u0026quot;1.11\u0026quot;, xs_len=4) at util.c:6422\n```\n# \u0026nbsp;11 0x00007ffff7fe497c in boot_Fcntl (cv=0x15119a0) at Fcntl.c:251\n# \u0026nbsp;12 0x00007ffff7b1324f in Perl_pp_entersub () at pp_hot.c:3046\n# \u0026nbsp;13 0x00007ffff7a9d5c3 in Perl_runops_debug () at dump.c:2266\n# \u0026nbsp;14 0x00007ffff79c7bee in Perl_call_sv (sv=0x10db648, flags=5) at perl.c:2632\n# \u0026nbsp;15 0x00007ffff79c761a in Perl_call_pv (sub_name=0xd914f2 \u0026quot;XSLoader::load\u0026quot;, flags=5)\n\n```\nat perl.c:2535\n```\n# \u0026nbsp;16 0x0000000000b5086d in dl_init () at extutils_cbuilder.c:223630\n# \u0026nbsp;17 0x0000000000b516cc in main (argc=1, argv=0x7fffffffe678, env=0x7fffffffe688)\n\n```\nat extutils_cbuilder.c:223776\n```","files":null}]}